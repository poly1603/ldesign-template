{"version":3,"file":"TemplateRenderer.vue2.js","sources":["../../src/components/TemplateRenderer.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { computed, watch, onMounted } from 'vue'\r\nimport type { Component } from 'vue'\r\nimport { useTemplate } from '../composables/useTemplate'\r\n\r\ninterface Props {\r\n  /**\r\n   * 模板ID\r\n   * 格式: \"category:device:name\" 或 \"category:device\"\r\n   */\r\n  templateId: string\r\n\r\n  /**\r\n   * 传递给模板的属性\r\n   */\r\n  props?: Record<string, any>\r\n\r\n  /**\r\n   * 后备组件\r\n   */\r\n  fallback?: Component\r\n\r\n  /**\r\n   * 加载成功回调\r\n   */\r\n  onLoad?: () => void\r\n\r\n  /**\r\n   * 加载失败回调\r\n   */\r\n  onError?: (error: Error) => void\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  props: () => ({}),\r\n})\r\n\r\nconst { component, loading, error, load } = useTemplate(\r\n  computed(() => props.templateId),\r\n  {\r\n    immediate: false,\r\n    onLoad: props.onLoad,\r\n    onError: props.onError,\r\n  }\r\n)\r\n\r\n// 监听模板ID变化并加载\r\nwatch(\r\n  () => props.templateId,\r\n  (newId) => {\r\n    if (newId) {\r\n      load(newId)\r\n    }\r\n  },\r\n  { immediate: true }\r\n)\r\n\r\nonMounted(() => {\r\n  if (props.templateId) {\r\n    load(props.templateId)\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"template-renderer\">\r\n    <!-- 加载中状态 -->\r\n    <div v-if=\"loading\" class=\"template-renderer__loading\">\r\n      <slot name=\"loading\">\r\n        <div class=\"template-renderer__spinner\">加载中...</div>\r\n      </slot>\r\n    </div>\r\n\r\n    <!-- 错误状态 -->\r\n    <div v-else-if=\"error\" class=\"template-renderer__error\">\r\n      <slot name=\"error\" :error=\"error\">\r\n        <div class=\"template-renderer__error-message\">\r\n          <p>模板加载失败</p>\r\n          <p class=\"template-renderer__error-detail\">{{ error.message }}</p>\r\n        </div>\r\n      </slot>\r\n    </div>\r\n\r\n    <!-- 渲染模板组件 -->\r\n    <component\r\n      v-else-if=\"component\"\r\n      :is=\"component\"\r\n      v-bind=\"props.props\"\r\n    >\r\n      <!-- 透传插槽 -->\r\n      <template v-for=\"(_, name) in $slots\" #[name]=\"slotProps\">\r\n        <slot :name=\"name\" v-bind=\"slotProps\" />\r\n      </template>\r\n    </component>\r\n\r\n    <!-- 后备内容 -->\r\n    <component v-else-if=\"fallback\" :is=\"fallback\" />\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.template-renderer {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.template-renderer__loading,\r\n.template-renderer__error {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 200px;\r\n  padding: 20px;\r\n}\r\n\r\n.template-renderer__spinner {\r\n  color: #409eff;\r\n  font-size: 14px;\r\n}\r\n\r\n.template-renderer__error {\r\n  color: #f56c6c;\r\n}\r\n\r\n.template-renderer__error-message {\r\n  text-align: center;\r\n}\r\n\r\n.template-renderer__error-message p {\r\n  margin: 0;\r\n  padding: 4px 0;\r\n}\r\n\r\n.template-renderer__error-detail {\r\n  font-size: 12px;\r\n  opacity: 0.8;\r\n}\r\n</style>"],"names":["props","__props","component","loading","error","load","useTemplate","computed","templateId","immediate","onLoad","onError","watch","newId","onMounted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA,IAAA,MAAMA,KAAAA,GAAQC,OAAAA;AAId,IAAA,MAAM;AAAA,MAAEC,SAAAA;AAAAA,MAAWC,OAAAA;AAAAA,MAASC,KAAAA;AAAAA,MAAOC;AAAAA,QAASC,WAAAA,CAC1CC,QAAAA,CAAS,MAAMP,KAAAA,CAAMQ,UAAU,CAAA,EAC/B;AAAA,MACEC,SAAAA,EAAW,KAAA;AAAA,MACXC,QAAQV,KAAAA,CAAMU,MAAAA;AAAAA,MACdC,SAASX,KAAAA,CAAMW;AAAAA,KAEnB,CAAA;AAGAC,IAAAA,KAAAA,CACE,MAAMZ,KAAAA,CAAMQ,UAAAA,EACXK,CAAAA,KAAAA,KAAU;AACT,MAAA,IAAIA,KAAAA,EAAO;AACTR,QAAAA,IAAAA,CAAKQ,KAAK,CAAA;AAAA,MACZ;AAAA,IACF,CAAA,EACA;AAAA,MAAEJ,SAAAA,EAAW;AAAA,KACf,CAAA;AAEAK,IAAAA,SAAAA,CAAU,MAAM;AACd,MAAA,IAAId,MAAMQ,UAAAA,EAAY;AACpBH,QAAAA,IAAAA,CAAKL,MAAMQ,UAAU,CAAA;AAAA,MACvB;AAAA,IACF,CAAC,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}